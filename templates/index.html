<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Rocket Control</title>
  <style>
    body { background:#111; color:#eee; font-family:sans-serif; text-align:center; }
    .frame { position:relative; display:inline-block; }
    .frame img.stream { width:800px; height:600px; }
    .frame img.crosshair {
      position:absolute; top:50%; left:50%;
      width:30%; height:30%; transform:translate(-50%,-50%);
      pointer-events:none; opacity:0.7;
    }
    .controls { margin-top:20px; }
    .controls button { margin:5px; padding:10px 20px; font-size:16px; }
  </style>
</head>
<body>
  <h1>USB Rocket Launcher Control</h1>
  <div class="frame">
    <img class="stream" src="{{ stream_url }}" />
    <img class="crosshair" src="/static/crosshair.svg" />
  </div>
  <div class="controls">
    <button onclick="move('up')">‚Üë Up</button><br/>
    <button onclick="move('left')">‚Üê Left</button>
    <button onclick="stop()">Stop</button>
    <button onclick="move('right')">Right ‚Üí</button><br/>
    <button onclick="move('down')">‚Üì Down</button><br/>
    <button onclick="fire()">üöÄ Fire</button>
  </div>
  <div class="sounds">
    <button onclick="sound('fatality')">Fatality (t)</button><br/>
    <button onclick="sound('fire-in-the-hole')">Fire in the hole! (f)</button><br/>
    <button onclick="sound('flashbang')">Flashbang (b)</button></br>
    <button onclick="sound('headshot')">Headshot (h)</button></br>
    <button onclick="sound('monster-kill')">Monster kill (m)</button>
  </div>


<script>
async function post(path, body={}) {
  await fetch(path, {method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify(body)});
}
function move(dir){ post("/api/move",{dir}); }
function stop(){ post("/api/stop"); }
function fire(){ post("/api/fire"); }
function sound(name) { post("/api/sound", {name}); }  

document.addEventListener("keydown", e => {
  if (e.key==="ArrowUp") move("up");
  if (e.key==="ArrowDown") move("down");
  if (e.key==="ArrowLeft") move("left");
  if (e.key==="ArrowRight") move("right");
  if (e.key==="Enter") fire();
  if (e.key===" ") stop();
  if (e.key==="t") sound("fatality");
  if (e.key==="f") sound("fire-in-the-hole");
  if (e.key==="b") sound("flashbang");
  if (e.key==="h") sound("headshot");
  if (e.key==="m") sound("monster-kill");
});
</script>
</body>
</html>

